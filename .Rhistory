area_data <- read.delim('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/era5/general/reference/data.txt')
setwd('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/era5/data/')
files_era <- data.table::data.table(list.files())
n_files <- nrow(files_era)
files_era$area <- substr(files_era$V1, start = 1, stop = 6)
file_area <- split(files_era, by = 'area')
n_areas <- length(file_area)
files_era
n_files
file_area
files_era$area <- substr(files_era$V1, start = 1, stop = 6)
file_area <- split(files_era, by = 'area')
n_areas <- length(file_area)
n_areas
for (i in 1:n_areas){
# i =1
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
write.csv(complete_series, paste(area,'_ERA5', '.csv', sep = ''))
}
for (i in 16:n_areas){
# i =1
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
write.csv(complete_series, paste(area,'_ERA5', '.csv', sep = ''))
}
for (i in 17:n_areas){
# i =1
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
write.csv(complete_series, paste(area,'_ERA5', '.csv', sep = ''))
}
for (i in 18:n_areas){
# i =1
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
write.csv(complete_series, paste(area,'_ERA5', '.csv', sep = ''))
}
i = 16
files <- file_area[[i]]$V1
files
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
df_era
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
i = 17
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
df_era
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
i = 16
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
df_era
i = 17
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
df_era
files
i = 15
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
area_data <- read.delim('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/era5/general/reference/data.txt')
setwd('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/era5/data/')
files_era <- data.table::data.table(list.files())
n_files <- nrow(files_era)
files_era$area <- substr(files_era$V1, start = 1, stop = 6)
file_area <- split(files_era, by = 'area')
n_areas <- length(file_area)
i = 15
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
i = 16
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
df_era
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
i = 14
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
df_era
i = 16
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
df_era
View(df_era)
get_df_era5
df_era
i = 14
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
View(df_era)
i = 17
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
i = 18
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
write.csv(complete_series, paste(area,'_ERA5', '.csv', sep = ''))
View(df_era)
i = 17
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
write.csv(complete_series, paste(area,'_ERA5', '.csv', sep = ''))
i = 1
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
write.csv(complete_series, paste(area,'_ERA5', '.csv', sep = ''))
i = 15
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
i = 16
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
fd_FordLabosier <- FordLabosier2017(vtime = df_d$time,
vswc = df_d$swvl1)
df_d <- df_era
fd_FordLabosier <- FordLabosier2017(vtime = df_d$time,
vswc = df_d$swvl1)
fd_FordLabosier
View(fd_FordLabosier)
View(fd_FordLabosier[[2]])
View(fd_FordLabosier[[1]])
nc_open('IT-Cpz2009.nc')
library(ncdf4)
nc_open('IT-Cpz2009.nc')
nc_open('DE-Geb2009.nc')
df_d
i = 16
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
i = 15
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
nc_open('IT-Cpz1999.nc')
df_era1 <- get_df_era5('IT-Cpz1999.nc', lat = latitude, lon = longitude, soil_layers = c(1))
df_era1
get_df_era5
i = 15
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
i = 16
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
latitude
lat = latitude
lon = longitude
soil_layers = c(1)
#Name of useful variables
list_var <- c('tp', 'pev', 'e', 't2m')
#get var name of provided soil layers
for (i in 1:length(soil_layers)){
list_var <- c(list_var, paste('swvl',soil_layers[i], sep = ''))
}
list_var
list_files = 'IT-Cpz1999.nc'
#get dates and hours
times_nc <- get.nc.data(lat,lon,list_files,list_var[1], file = F)[,1]
times_nc
df <- data.frame(time = times_nc)
#get series for all variables provided
for ( i in 1:length(list_var)){
df[,i+1] <- get.nc.data(lat,lon,list_files,list_var[i], file = F)[,2]
}
# rename columns and set correct units
colnames(df) <- c('time', list_var)
df$tp <- df$tp*1000 # convert to mm
df$t2m <- df$t2m - 273.15 # convert to degrees C
df$pev <- -df$pev*1000 # convert to mm and adjust direction
df$e <- -df$e*1000 # convert to mm and adjust direction
df
df$pev
df <- data.frame(time = times_nc)
df
#get series for all variables provided
for ( i in 1:length(list_var)){
df[,i+1] <- get.nc.data(lat,lon,list_files,list_var[i], file = F)[,2]
}
df
list_var
test <- get.nc.data(lat,lon,list_files,list_var[5], file = F)[,2]
test
lat = latitude + 0.25
lon = longitude
soil_layers = c(1)
list_files = 'IT-Cpz1999.nc'
#Name of useful variables
list_var <- c('tp', 'pev', 'e', 't2m')
#get var name of provided soil layers
for (i in 1:length(soil_layers)){
list_var <- c(list_var, paste('swvl',soil_layers[i], sep = ''))
}
#get dates and hours
times_nc <- get.nc.data(lat,lon,list_files,list_var[1], file = F)[,1]
df <- data.frame(time = times_nc)
test <- get.nc.data(lat,lon,list_files,list_var[5], file = F)[,2]
test
latitude
longitude
area_data
lat = latitude
lon = longitude
soil_layers = c(1)
list_files = 'IT-Cpz1999.nc'
soil_layers = c(2)
list_files = 'IT-Cpz1999.nc'
#Name of useful variables
list_var <- c('tp', 'pev', 'e', 't2m')
#get var name of provided soil layers
for (i in 1:length(soil_layers)){
list_var <- c(list_var, paste('swvl',soil_layers[i], sep = ''))
}
list_var
#get series for all variables provided
for ( i in 1:length(list_var)){
df[,i+1] <- get.nc.data(lat,lon,list_files,list_var[i], file = F)[,2]
}
test <- get.nc.data(lat,lon,list_files,list_var[5], file = F)[,2]
test
list_files = 'IT-Cpz2009.nc'
#Name of useful variables
list_var <- c('tp', 'pev', 'e', 't2m')
#get var name of provided soil layers
for (i in 1:length(soil_layers)){
list_var <- c(list_var, paste('swvl',soil_layers[i], sep = ''))
}
#get dates and hours
times_nc <- get.nc.data(lat,lon,list_files,list_var[1], file = F)[,1]
df <- data.frame(time = times_nc)
test <- get.nc.data(lat,lon,list_files,list_var[5], file = F)[,2]
test
list_files = 'DE-Geb2009.nc'
#Name of useful variables
list_var <- c('tp', 'pev', 'e', 't2m')
#get var name of provided soil layers
for (i in 1:length(soil_layers)){
list_var <- c(list_var, paste('swvl',soil_layers[i], sep = ''))
}
#get dates and hours
times_nc <- get.nc.data(lat,lon,list_files,list_var[1], file = F)[,1]
df <- data.frame(time = times_nc)
test <- get.nc.data(lat,lon,list_files,list_var[5], file = F)[,2]
test
list_files = 'DE-Cpz2009.nc'
#Name of useful variables
list_var <- c('tp', 'pev', 'e', 't2m')
#get var name of provided soil layers
for (i in 1:length(soil_layers)){
list_var <- c(list_var, paste('swvl',soil_layers[i], sep = ''))
}
#get dates and hours
times_nc <- get.nc.data(lat,lon,list_files,list_var[1], file = F)[,1]
df <- data.frame(time = times_nc)
list_files = 'IT-Cpz2009.nc'
#Name of useful variables
list_var <- c('tp', 'pev', 'e', 't2m')
#get var name of provided soil layers
for (i in 1:length(soil_layers)){
list_var <- c(list_var, paste('swvl',soil_layers[i], sep = ''))
}
#get dates and hours
times_nc <- get.nc.data(lat,lon,list_files,list_var[1], file = F)[,1]
df <- data.frame(time = times_nc)
test <- get.nc.data(lat,lon,list_files,list_var[5], file = F)[,2]
test
print(paste(i,area, sep = '-'))
i = 15
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
list_files = 'IT-Col2009.nc'
#Name of useful variables
list_var <- c('tp', 'pev', 'e', 't2m')
#get var name of provided soil layers
for (i in 1:length(soil_layers)){
list_var <- c(list_var, paste('swvl',soil_layers[i], sep = ''))
}
#get dates and hours
times_nc <- get.nc.data(lat,lon,list_files,list_var[1], file = F)[,1]
df <- data.frame(time = times_nc)
test <- get.nc.data(lat,lon,list_files,list_var[5], file = F)[,2]
test
i = 15
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
write.csv(complete_series, paste(area,'_ERA5', '.csv', sep = ''))
i = 15
i = 15
area_data <- read.delim('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/era5/general/reference/data.txt')
setwd('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/era5/data/')
files_era <- data.table::data.table(list.files())
n_files <- nrow(files_era)
files_era$area <- substr(files_era$V1, start = 1, stop = 6)
file_area <- split(files_era, by = 'area')
n_areas <- length(file_area)
i = 15
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
area_data <- read.delim('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/era5/general/reference/data.txt')
setwd('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/era5/data/')
files_era <- data.table::data.table(list.files())
n_files <- nrow(files_era)
files_era$area <- substr(files_era$V1, start = 1, stop = 6)
file_area <- split(files_era, by = 'area')
n_areas <- length(file_area)
n_areas
i = 15
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
files
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
area_data <- read.delim('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/era5/general/reference/data.txt')
setwd('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/era5/data/')
files_era <- data.table::data.table(list.files())
n_files <- nrow(files_era)
files_era$area <- substr(files_era$V1, start = 1, stop = 6)
file_area <- split(files_era, by = 'area')
n_areas <- length(file_area)
i = 15
files <- file_area[[i]]$V1
area <- substr(files[1], start = 1, stop = 6)
id <- which(area == area_data$station)
latitude <- area_data$lat1[id] + 1
longitude <- area_data$lon1[id] + 1
print(paste(i,area, sep = '-'))
df_era <- get_df_era5(files, lat = latitude, lon = longitude, soil_layers = c(1))
complete_series <- process_all(df_era, include_variables = T, data = 'reanalysis')[[1]]
write.csv(complete_series, paste(area,'_ERA5', '.csv', sep = ''))
################################## FLUXNET #########################################
flux_dir <- 'C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/fluxnet/'
flux_files <- list.files(flux_dir)
flux_files <- flux_files[-c(1)]
flux_names <- substr(flux_files, start = 5, stop = 10)
flux_names
flux_files
runApp('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/FD-Viz')
################################## FLUXNET #########################################
flux_dir <- 'C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/fluxnet/'
flux_files <- list.files(flux_dir)
flux_files <- flux_files[-c(1)]
flux_names <- substr(flux_files, start = 5, stop = 10)
flux_names
################################# SINGLE PROCESS ################################
i = 15
# test <- read.csv(paste(flux_dir,flux_files[i], sep = ''))
# View(test)
#build DF
df_d <- df_fluxnet(paste(flux_dir,flux_files[i], sep = ''), timestep = 'day', soil_level = 1)
flux_files[i]
#Process methods
complete_series <- process_all(df_d, include_variables = T)[[1]]
#export file
write.csv(complete_series, paste(flux_names[i], '.csv', sep = ''))
runApp('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/FD-Viz')
runApp('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/FD-Viz')
runApp('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/FD-Viz')
data_stations
data_stations <- read.delim('stations.txt')
runApp('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/FD-Viz')
runApp('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/FD-Viz')
runApp('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/FD-Viz')
runApp('C:/Users/pedro/OneDrive/@DOUTORADO/@@TU-Berlin/@Artigos/CAP 4/@run_EU_Stations/FD-Viz')
